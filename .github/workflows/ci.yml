name: CI (static site)

on:
  workflow_dispatch:
  push:
    branches: [ "**" ]
    paths:
      - "**/*.html"
      - "**/*.css"
      - "**/*.js"
      - ".github/workflows/**"
  pull_request:
    branches: [ "**" ]
    paths:
      - "**/*.html"
      - "**/*.css"
      - "**/*.js"
      - ".github/workflows/**"

permissions:
  contents: read
  checks: write
  statuses: write
  pull-requests: write

jobs:
  checks:
    name: Basic checks
    runs-on: ubuntu-latest
    steps:
      - name: Checkout (full history)
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Super-Linter
        uses: super-linter/super-linter@v7
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          VALIDATE_ALL_CODEBASE: true
          VALIDATE_HTML: true
          VALIDATE_CSS: true
          VALIDATE_JAVASCRIPT_STANDARD: true
          FILTER_REGEX_EXCLUDE: "assets/vendor/.*|.*\\.min\\.(js|css)$"

      - name: Link Checker (internal links only)
        uses: lycheeverse/lychee-action@v2
        with:
          args: >
            --verbose
            --no-progress
            --accept 200,206,429
            --exclude 'https://fonts\.googleapis\.com'
            --exclude 'https://fonts\.gstatic\.com'
            --exclude 'https://bootstrapmade\.com'
            --exclude 'https://twitter\.com'
            --exclude 'https://(www\.)?facebook\.com'
            --exclude 'https://www\.instagram\.com'
            --exclude 'https://(www\.)?linkedin\.com'
            .
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
